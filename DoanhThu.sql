SELECT * FROM HoaDon
UPDATE HoaDon SET TRANGTHAI =2 WHERE ID='14E1863B-9ECA-4CF0-BB7F-4FA5DE804B1F'
UPDATE HOADON SET THANHTIEN=(SELECT SUM(DONGIA*SOLUONG) FROM ChiTietHoaDon WHERE IDHD='6108264C-5E64-4395-B945-F91B42E90593')  WHERE ID='6108264C-5E64-4395-B945-F91B42E90593'
SELECT * FROM HOADON WHERE DAY(NgayTao)=DAY(GETDATE()) AND TrangThai=2
ALTER FUNCTION FNDTNGAY(@ngay DATE)
RETURNS @dtngay TABLE (doanhthu Decimal,thanhcong int,bihuy int)
AS
begin
DECLARE @dt decimal=0,@tc int=0,@bihuy int=0;
 SELECT @dt=SUM(THANHTIEN) FROM HOADON WHERE DAY(NGAYTAO)=DAY(@ngay) AND TRANGTHAI=1
 SELECT @tc=(SELECT COUNT(MAHD) FROM HOADON WHERE TRANGTHAI=1) FROM HOADON WHERE DAY(NGAYTAO)=DAY(@ngay)
 SELECT @bihuy= (SELECT COUNT( MAHD )FROM HOADON WHERE TRANGTHAI=2) FROM HOADON WHERE DAY(NGAYTAO)=DAY(@ngay)
INSERT INTO @dtngay VALUES(@dt,@tc,@bihuy)
RETURN
end
SELECT * FROM dbo.FNDTNGAY(GETDATE())
SELECT SUM(ThanhTien)AS DT,(SELECT COUNT(MAHD)FROM HOADON WHERE TRANGTHAI=1) AS SODON FROM HoaDon 
GROUP BY THANHTIEN,MAHD
SELECT COUNT(MAHD) FROM HOADON
SELECT * FROM HOADON
UPDATE HOADON SET NgayTao='2022-02-03' WHERE MaHD='HD3'
CREATE PROC SP_DTCACNAM 
as
begin
	SELECT YEAR(ngaytao)as [year], COUNT(MAHD) AS SODON,SUM(ThanhTien) AS DoanhThu FROM HOADON where trangthai=1  group by year(ngaytao)
end
EXEC SP_DTCACNAM
SELECT DISTINCT Month(NGAYTAO) as [YEAR] FROM HOADON WHERE NGAYTAO IS NOT NULL ORDER BY [YEAR] DESC
select * from ChiTietSanPham
SELECT * FROM KhachHang
delete FROM ChiTietHoaDon where idctsp='D6718367-AE49-402F-9FC4-A2AE23D498B2'
delete from khuyenmai
delete from ChiTietSanPham where id='D6718367-AE49-402F-9FC4-A2AE23D498B2'
select * from chitietsanpham
select * from ChiTietHoaDon
CREATE TRIGGER TRANGTHAISP ON CHITIETSANPHAM AFTER UPDATE AS
BEGIN
	IF (SELECT INSERTED.SOLUONG FROM CHITIETSANPHAM JOIN INSERTED ON CHITIETSANPHAM.ID=INSERTED.ID)=0
	BEGIN
	UPDATE CHITIETSANPHAM SET TRANGTHAI=0 FROM CHITIETSANPHAM JOIN INSERTED ON CHITIETSANPHAM.ID=INSERTED.ID
	END
END
UPDATE HOADON SET TRANGTHAI=0 WHERE MaHD='HD5'
UPDATE KHACHHANG SET NGAYTHAMGIA='2023-04-02' WHERE MAKH='KH01'
SELECT Month(ngaytao)as [month], COUNT(MAHD) AS SODON,SUM(ThanhTien) AS DoanhThu FROM HOADON where trangthai=1 and year(ngaytao)=2023 group by month(ngaytao)